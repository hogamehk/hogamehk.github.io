<!DOCTYPE html>
<html lang="zh-hk">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>公告新聞 - uiduid.com</title>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            background: #1a1a1a;
            color: #fff;
            font-size: 14px;
            line-height: 1.6;
            padding-bottom: 80px;
        }

        /* 頂部導航 */
        .top-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: #242424;
            position: sticky;
            top: 0;
            z-index: 999;
            gap: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        .logo {
            font-size: 18px;
            font-weight: bold;
            color: #ff8c00;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-actions {
            display: flex;
            gap: 8px;
        }
        .nav-btn {
            padding: 6px 10px;
            border: 1px solid #ff8c00;
            border-radius: 4px;
            color: #ff8c00;
            text-decoration: none;
            font-size: 12px;
            white-space: nowrap;
            transition: all 0.3s;
        }
        .nav-btn:hover {
            background: #ff8c00;
            color: #fff;
        }

        /* 主內容區 */
        .container {
            max-width: 1000px;
            margin: 30px auto;
            padding: 0 15px;
        }
        .page-title {
            font-size: 24px;
            font-weight: bold;
            color: #ff8c00;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        /* 新聞列表 */
        .news-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .news-item {
            background: #242424;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .news-item:hover {
            transform: translateY(-3px);
            background: rgba(255, 140, 0, 0.1);
        }
        .news-date {
            font-size: 12px;
            color: #ff8c00;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .news-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #fff;
        }
        .news-summary {
            font-size: 13px;
            color: #ccc;
            line-height: 1.5;
        }

        /* 尾部 */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #242424;
            padding: 15px 0;
            text-align: center;
            border-top: 2px solid #ff8c00;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
            z-index: 998;
        }
        .footer-content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 15px;
        }
        .footer-text {
            color: #ccc;
            font-size: 12px;
        }
        .footer-text span {
            color: #ff8c00;
            font-weight: bold;
        }

        /* 回到頂部 */
        .back-to-top {
            position: fixed;
            bottom: 70px;
            right: 20px;
            width: 45px;
            height: 45px;
            background: #ff8c00;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #fff;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(255, 140, 0, 0.5);
            transition: all 0.3s;
            opacity: 0;
            visibility: hidden;
            z-index: 999;
        }
        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }
        .back-to-top:hover {
            background: #ff6700;
            transform: translateY(-3px);
        }

        /* 載入狀態 */
        .loading, .error {
            text-align: center;
            color: #aaa;
            padding: 40px 0;
        }
        .error {
            color: #f44;
        }

        /* === 模態框 Modal === */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: #242424;
            color: #fff;
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 12px;
            padding: 25px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ff8c00;
            color: #000;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.2s;
        }
        .modal-close:hover {
            background: #ff6700;
        }
        .modal-date {
            font-size: 13px;
            color: #ff8c00;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .modal-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #fff;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }
        .modal-body {
            font-size: 15px;
            line-height: 1.7;
            color: #ddd;
            white-space: pre-line; /* 保留換行符 \n */
        }
    </style>
</head>
<body>
    <!-- 頂部導航 -->
    <div class="top-nav">
        <a href="https://www.uiduid.com" class="logo"><i class="fas fa-gamepad"></i> uiduid.com</a>
        <div class="nav-actions">
            <a href="https://www.uiduid.com" class="nav-btn">返回首頁</a>
        </div>
    </div>

    <!-- 主內容 -->
    <div class="container">
        <h1 class="page-title"><i class="fas fa-bullhorn"></i> 公告新聞</h1>
        <div class="news-list" id="newsList">
            <p class="loading">載入公告中...</p>
        </div>
    </div>

    <!-- 尾部 -->
    <div class="footer">
        <div class="footer-content">
            <p class="footer-text">© 2026 <span>uiduid.com</span> 遊戲點卡商城 版權所有</p>
        </div>
    </div>

    <!-- 回到頂部按鈕 -->
    <div class="back-to-top" id="backToTop" title="回到頂部">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- 模態框（預設隱藏） -->
    <div class="modal-overlay" id="newsModal">
        <div class="modal-content">
            <div class="modal-close" id="modalClose">×</div>
            <div class="modal-date" id="modalDate"><i class="far fa-calendar-alt"></i> <span></span></div>
            <h2 class="modal-title" id="modalTitle"></h2>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <script>
        let newsCache = []; // 快取新聞資料

        // ========== 讀取 news.json ==========
        async function loadNews() {
            const newsList = document.getElementById('newsList');
            try {
                const response = await fetch('/data/news.json');
                if (!response.ok) throw new Error('無法載入 news.json');
                newsCache = await response.json();

                // 按日期排序（新 → 舊）
                // 先按 pinned 排序（true 在前），再按日期（新到舊）
newsCache.sort((a, b) => {
  const aPinned = a.pinned === true ? 1 : 0;
  const bPinned = b.pinned === true ? 1 : 0;
  if (bPinned !== aPinned) {
    return bPinned - aPinned; // pinned=true 排前面
  }
  return new Date(b.date) - new Date(a.date); // 同類別內按日期排序
});

                if (newsCache.length === 0) {
                    newsList.innerHTML = '<p style="text-align:center;color:#ff8c00;">目前沒有公告</p>';
                    return;
                }

                newsList.innerHTML = newsCache.map(item => `
                    <div class="news-item" data-id="${item.id}">
                        <div class="news-date">
                            <i class="far fa-calendar-alt"></i> ${item.date}
                        </div>
                        <h2 class="news-title">${item.title}</h2>
                        <p class="news-summary">${item.summary}</p>
                    </div>
                `).join('');

                // 綁定點擊事件
                document.querySelectorAll('.news-item').forEach(el => {
                    el.addEventListener('click', () => {
                        const id = el.getAttribute('data-id');
                        const item = newsCache.find(n => n.id === id);
                        if (item) showNewsModal(item);
                    });
                });

            } catch (err) {
                console.error('載入失敗:', err);
                newsList.innerHTML = '<p class="error">公告載入失敗，請稍後再試。</p>';
            }
        }

        // ========== 顯示模態框 ==========
        function showNewsModal(item) {
            document.getElementById('modalDate').querySelector('span').textContent = item.date;
            document.getElementById('modalTitle').textContent = item.title;
            document.getElementById('modalBody').textContent = item.content || item.summary;

            const modal = document.getElementById('newsModal');
            modal.classList.add('show');

            // 防止背景滾動
            document.body.style.overflow = 'hidden';
        }

        // ========== 關閉模態框 ==========
        function closeNewsModal() {
            document.getElementById('newsModal').classList.remove('show');
            document.body.style.overflow = ''; // 恢復滾動
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            loadNews();

            // 關閉按鈕
            document.getElementById('modalClose').addEventListener('click', closeNewsModal);

            // 點擊遮罩關閉
            document.getElementById('newsModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) closeNewsModal();
            });

            // 按 Esc 關閉
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && document.getElementById('newsModal').classList.contains('show')) {
                    closeNewsModal();
                }
            });

            // 回到頂部
            const backToTop = document.getElementById('backToTop');
            window.addEventListener('scroll', () => {
                backToTop.classList.toggle('show', window.scrollY > 300);
            });
            backToTop.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
    </script>
</body>
</html>